/* This is a test for the examples from   */
/* the interactive electronic version of  */
/* "Algorithms in Real Algebraic Geometry"*/
/* by S. Basu, R. Pollack, M.-F. Roy      */
/* coded by F. Caruso                     */


/* -------------------------------------- */
/* Chapter                              8 */
  
(kill(all), load(sarag),0);
0$

list2poly(getCoeffFromNewton([3,0,2,0]),x);
x^3-x;


/* matrixProd */
/* the example should be changed */
matrixProd([[0,1],[0,1]],[[0,1],[0,1]]);
[[0,1],[0,1]];

gaussDet([[1,2,3],[2,3,4],[3,4,6]]);
-1;

bareissDet([[1,2,3],[2,3,4],[3,4,6]]);
-1;

babyGiantCharPol(
[
[1,2,3,4],
[2,3,4,5],
[3,4,5,6],
[5,6,7,8]],x);
x^4-17*x^3-26*x^2;

/* sRem */
string(ratsimp(sRem(x^4+a*x^2+b*x+c,diff(x^4+a*x^2+b*x+c,x),x)));
"[x^4+a*x^2+b*x+c,4*x^3+2*a*x+b,-(2*a*x^2+3*b*x+4*c)/4,((8*a*c-9*b^2-2*a^\
3)*x-12*b*c-a^2*b)/a^2,(256*a^2*c^3-128*a^4*c^2+(144*a^3*b^2+16*a^6)*c-27*a^2*\
b^4-4*a^5*b^2)/(256*a^2*c^2+(-576*a*b^2-128*a^4)*c+324*b^4+144*a^3*b^2+16*a^6)]";


sRem(x^11-x^10+1,11*x^10-10*x^9,x);
[x^11-x^10+1,
11*x^10-10*x^9,
(10*x^9-121)/121,
-((1331*x-1210)/10),
275311670611/285311670611];


sRemExt(x^3+2*x^2+3*x+4,3*x^2+4*x+3,x);
[[
x^3+2*x^2+3*x+4,
3*x^2+4*x+3,
-((10*x+30)/9),
-18],
[1,0,-1,27*x/10-9/2,x^2/6+2*x/9+1/6],
[0,1,x/3+2/9,9*x/10-(9*x^2/10),-(x^3/18+x^2/9+x/6+2/9)]];


/* sSubRes */
sSubRes(x^4+a*x^2+b*x+c,
diff(x^4+a*x^2+b*x+c,x),x);
[
 [x**4+a*x**2+b*x+c,4*x**3+2*a*x+b,
  -8*a*x**2-12*b*x-16*c,
  32*a*c*x-36*b**2*x-8*a**3*x-48*b*c-4*a**2*b,
  256*c**3-128*a**2*c**2+144*a*b**2*c+16*a**4*c-27*b**4-4*a**3*b**2],
 [1,
  4,
  -8*a,
  32*a*c-36*b**2-8*a**3,
  256*c**3-128*a**2*c**2+(144*a*b**2+16*a**4)*c-27*b**4-4*a**3*b**2
 ]
];


sSubRes(x^4+b*x+c,4*x^3+b,x);
[[x^4+b*x+c,
4*x^3+b,
-12*b*x-16*c,
-36*b^2*x-48*b*c,
256*c^3-27*b^4],
[1,4,0,-36*b^2,256*c^3-27*b^4]];

sSubRes(x^11-x^10+1,diff(x^11-x^10+1,x),x);
[
 [x**11-x**10+1,
  11*x**10-10*x**9,
  10*x**9-121,100-110*x,
  0,0,0,0,0,0,
  2143588810*x-1948717100,
  -275311670611],
 [1,11,10,0,0,0,0,0,0,0,2143588810,-275311670611]
];



/* sSubResExt */
sSubResExt(x^4+b*x+c,4*x^3+b,x);
[
 [x**4+b*x+c,
  4*x**3+b,
  -12*b*x-16*c,
  -36*b**2*x-48*b*c,
  256*c**3-27*b**4],
 [1,4,0,-36*b**2,256*c**3-27*b**4],
 [1,0,-16,-48*b,
  144*b**2*x**2-192*b*c*x+256*c**2,
  -1024*c**3*x**3+108*b**4*x**3-256*b*c**3+27*b**5
 ],
 [0,1,4*x,
  12*b*x,
  -36*b**2*x**3+48*b*c*x**2-64*c**2*x-27*b**3,
  256*c**3*x**4-27*b**4*x**4+256*b*c**3*x-27*b**5*x+256*c**4-27*b**4*c
 ]
];


/* -------------------------------------- */
/* Chapter                              9 */

sRemCauchyIndex(
(x-5)*(x-4)*(x-2)*(x+1)*(x+2)*(x+4),
(x-3)^2*(x-1)*(x+3),x);
0;


sRemTarskiQuery(1,x^11-x^10+1,x);
1;

sRemTarskiQuery(x,x^11-x^10+1,x);
-1;

sRemTarskiQueryBetween(1,x^11-x^10+1,x,-1,0);
1;

sRemTarskiQueryBetween(x,x^11-x^10+1,x,-1,0);
-1;

sSubResCauchyIndex(
(x-5)*(x-4)*(x-2)*(x+1)*(x+2)*(x+4),
(x-3)^2*(x-1)*(x+3),x);
0;

sSubResTarskiQuery(
1,
9*x^13-18*x^11-33*x^10+102*x^8+7*x^7-36*x^6-122*x^5+
49*x^4+93*x^3-42*x^2-18*x+9,x);
6;

sSubResTarskiQuery(
x,
9*x^13-18*x^11-33*x^10+102*x^8+7*x^7-36*x^6-122*x^5+
49*x^4+93*x^3-42*x^2-18*x+9,x);
2;

sSubResTarskiQuery(1,x^11-x^10+1,x);
1;

sSubResTarskiQuery(x,x^11-x^10+1,x);
-1;


sSubResTarskiQueryBetween(1,x^11-x^10+1,x,-1,0);
1;


sSubResTarskiQueryBetween(x,x^11-x^10+1,x,-1,0);
-1;

posNegDiff((x^2-1)*(x^3-1),x);
-1;


/* -------------------------------------- */
/* Chapter                             10 */

gcdFreePart((x^2-1)*(x+2),(x+1)*x,x);
[2*x+2,2*x^2+2*x-4];

convert2Bernstein(x^2,2,x,0,1);
[0,0,1];

convert2Bernstein(x^2,3,x,0,1);
[0,0,1/3,1];

convert2Bernstein(-33*x^3+69*x^2-30*x+4,3,x,0,1);
[4,-6,7,10];

specialBernsteinSplit([4,-6,7,10],0,1);
[
[32,-8,-2,17],
[17,36,68,80]];

specialBernsteinSplit([32,-8,-2,17],0,1/2);
[
[256,96,28,19],
[19,10,60,136]
];

deCasteljauIsolateRoots(-33*x^3+69*x^2-30*x+4,x);
[[1,2]];

deCasteljauIsolateRoots(9*x^13-18*x^11-33*x^10+102*x^8
+7*x^7-36*x^6-122*x^5+49*x^4+93*x^3-42*x^2-18*x+9,x);
[[-2,-1],[-1,0],[1/2,5/8],[5/8,3/4],[1],[1,2]];

deCasteljauIsolateRoots(10*x^3+21*(1-x)*x^2-
18*(1-x)^2*x+4*(1-x)^3,x);
[[1,2]];

deCasteljauSignsAtRoots(
  deCasteljauIsolateRoots((x-2)*(x^2-1),x),
  (x-2)*(x^2-1),
  x^2-4,
  x);
[[[-2,0],-1],[[0,2],-1],[[2],0]];

deCasteljauCompareRoots(
 x^2-4,
 (x^3-2*x^2-x+3)*(x-2),
 x);
[
 [[2]],
 [[[-2],1]],
 [[[-2,0],-1]]
];

naiveSignDetermination(
 [x,x+1,x-2],
 x^5-9*x^3-x^2+9,
 sSubResTarskiQuery,x);
[[-1,-1,-1],[1,1,-1],[1,1,1]];

smartSignDetermination(
 [x,x+1,x-2],
 x^5-9*x^3-x^2+9,
 sSubResTarskiQuery,x);
[[1,1,1],[1,1,-1],[-1,-1,-1]];

thomEncoding(x^2-2,x);
[[-1,1],[1,1]];

thomEncoding(
9*x^13-18*x^11-33*x^10+102*x^8+7*x^7
-36*x^6-122*x^5+49*x^4+93*x^3-42*x^2
-18*x+9,x);
[
 [1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1],
 [0,1,-1,1,-1,1,1,-1,1,-1,1,-1,1],
 [-1,1,-1,1,1,-1,-1,-1,1,1,1,1,1],
 [0,-1,-1,1,1,-1,-1,1,1,1,1,1,1], 
 [1,1,-1,-1,1,1,1,1,1,1,1,1,1],
 [0,1,1,1,1,1,1,1,1,1,1,1,1]
];
 

thomCompare(
 x^2-4,
 expand((x-2)*(x^3-1)),x);
[[1, [- 1, 1]], [2, [- 1, 0, 1, 1]], 
[0, [1, 1], [1, 1, 1, 1]]];



/* -------------------------------------- */
/* Chapter                             11 */

/* not yet in the book */
archimedianTopology(x^2+y^2-1,deCasteljauIsolateRoots,x,y);
[0,[0,[1,1],2,[1,1],0]];


/* ------------------------------------------------------- */
/* Not in the book */
/* ------------------------------------------------------- */


/* Certificate of positivity */


certificate(5*x^2-4*x+1,x);
[1,
[
[[- 1, 0], 1, [10, 3, 1]],
[[0, 1/2], 4, [4, 0, 1]],
[[1/2, 1], 4, [1, 2, 8]]
]
];


certificate(x^4+(8*x-1)^2,x);
[1,
[
[[- 1, 0], 3, [246, 135, 59, 15, 3]],
[[0, 1/8], 12288, [12288, 6144, 2048, 0, 3]],
[[1/8, 1], 12288, [3, 24, 100544, 302592, 614400]]
]
];


certificate(x^4 + (2*x-1)^2,x);
[1,
[
[[- 1, 0], 3, [30, 18, 11, 6, 3]],
[[0, 1/2], 48, [48, 24, 8, 0, 3]],
[[1/2, 1], 48, [3, 6, 20, 48, 96]]
]
];


