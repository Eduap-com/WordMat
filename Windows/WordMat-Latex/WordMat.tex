% !TEX encoding = ISO-8859-1
\documentclass[11pt]{article}
\usepackage[T1]{fontenc}
\usepackage[latin1]{inputenc}
\usepackage{geometry}
\geometry{a4paper}
\usepackage[USenglish]{babel}
\usepackage{amsmath}

\title{WordMat}
\author{Mikael Samsøe Sørensen}

\begin{document}
\pagestyle{empty}
\thispagestyle{empty}
\maketitle
\thispagestyle{empty}
\newpage
\tableofcontents
\newpage

This file has VBA-code attached. To see/edit the code press Alt+F11 (Mac: option+fn+F11)\newline
(or Visual Basic in the developer tab. Settings | Customize toolbar | check developer) \newline
To execute macros press Alt+F8 (Mac: option+fn+F8) or use the developer menu. \textit{BackupThisDocument}  | ExportAllModules |\textit{ }ImportAllModules \textit{}GenerateKeyboardShortcutsWordMat |\textit{ RunTestSequence | RunTestSequenceNonInteractiveExports all modules to folder 'VBA-modules'. VBA-modules is not overwritten, but changed to VBA-modules-Backupx\newline
Backup makes a copy of this file in subfolder Backup. Any existing Backup-file gets a number attached so not to overwrite previous backups.
}For ExportAllModules and ImportAllModules to work you need:
\begin{itemize}
 \item Add reference 'Microsoft Visual Basic for Applications Extensibility 5.3' in VBA-Ide tools/references \item Settings | Trust center | Settings for macros | always trust VBA project object model\end{itemize}\textit{Do not upgrade this file to a newer Word-version. It will break menu compatibility.
Do not add buttons inside the document, it will increase loadtime.
}\textbf{ImportAllModules
}Imports all modules from subfolder 'VBA-modules' (Most recent backup from ExportAllModules). All existing modules in the document are deleted. Import cannot be run using a button.
\textbf{Word Crash
}Sometimes this document will crash when opened. Disable all macros in security center. Open the document. Open VBE and compile (Maybe make some code changes first). Save and close. Reenable macros and open the document again will often resolve the problem. If not try other code changes. RibbonCommanders VBA Code cleaner will also solve the problem.
\textbf{Keyboard Shortcuts
}Problems often occur with keyboard shortcuts. They can be in normal.dotm instead of WordMat.dotm. Also Keyboard shortcuts are not compatible with Mac because Mac uses option button instead of Alt.

Before a new release do this:
\begin{enumerate}
 \item \textit{Run CheckKeyboardShortcuts on Windows }to check if KeyBoard shortcuts are ok. \item \textit{On Mac run }GenerateKeyboardShortcuts and then \textit{CheckKeyboardShortcuts}\end{enumerate}\textbf{Special Character problem when editing on Mac and Windows
}The VBE-Codefiles on Mac and Windows are not compatible. ASCII-characters(0-127) is not a problem. The problem comes from the extended ASCII-table (128-255), since Windows uses ANSI codepages, while Mac uses xx(Unicode?).
ASCII-characters: &%_^|\@~\newline
Extended Characters that \textit{are} compatible: £(163), ©, µ\newline
Problems both ways: ¤\newline
Problems Windows to Mac: ½, .\newline
Problems Mac to Windows: ø æ å Æ Ø Å á é ó À §There are few problems from Windows to Mac (¤,½). Just don't use those characters in the code or comments, or use ChrW(164) and ChrW(189). There are more problematic characters than the above, but they are the most common. To convert scrambled characters from a Mac-edit back to Windows ANSI, run the macro: \textit{'ReplaceToANSI'\newline
}The character problem only affects codefiles, not characters in the document.\textbf{Strategy 1 to overcome character problem\newline
}Make all code changes on Windows. WordMat.dotm can be opened and tested on Mac. Just don't save and overwrite the original and reopen on Windows. If this happens use function \textit{ReplaceToANSI}.\newline
This must be run every time a Mac-edit has been done, or else the characters will convert to random new characters every roundtrip to mac and back, and then it cannot be undone.\textbf{Strategy 2 \newline
}Run \textit{ReplaceToASCIIseq} to convert all problematic characters to ascii-sequences. You can then open the document on Windows and Mac independently. However the characters will show in the ui scrambled by the ascii-sequences. Before building the installer make sure to run \textit{ReplacetoExtendedASCII}. Preferably independently on Windows and Mac.\newline
Also if you introduce more non-ascii characters, make sure to run \textit{ReplaceToASCIIseq} again.Run 'GenerateKeyBoardShortcuts' whenever you have run \textit{ReplaceToASCIIseq or ReplacetoExtendedASCII}.\textbf{

How to work with Git-hub and VBA-modules
}The idea is to always end by exporting all VBA-modules to the folder 'VBA-modules'. \newline
Whenever you start to code, start by importing. The advantage of this method is that Git can then track changes in the exported modules, and multiple people can work on the VBA-code. It cannot do that within a word-file. Sometimes Wordmat.dotm fails to open for unknown reasons. In that case a previous version of Wordmat.dotm can be opened and the most recent modules imported, to restore the document.\newline
\textit{Don't use Export/import modules on Mac. It's not compatible with Windows export/import.}
Functions in VBAmodul:
\begin{itemize}
 \item ImportAllModules\newline
Imports all forms, classes and modules from subfolder 'VBA-modules'. Removes all existing modules before import, including VBAmodul \item ExportAllModules\newline
Exports all forms, classes and modules from current project to subfolder 'VBA-modules'\newline
(including VBAmodul) All current content in folder is deleted before export. A logfile with date is added to the folder. \item RemoveAllModules\newline
Removes all forms, classes and modules from current project, except VBAmodul.bas.\end{itemize}
The work process is
\begin{enumerate}
 \item You have a WordMat.dotm file you are working on in folder WordMat/Windows \item When done coding run 'ExportAllModules' \item Push to github origin \item When resuming coding start by pulling from github \item Open your WordMat.dotm file and start by running 'ImportAllModules' \item Run 'GenerateKeyBoardShortcuts' as these are lost when importing\end{enumerate}\textbf{Before Building installer\begin{enumerate}
 \item }Run '\textit{ReplacetoExtendedASCII' (if using strategy 2)} \item Run '\textit{GenerateKeyboardShortcutsWordMat}'\end{enumerate}
1 & 2 must be run separately on Windows and Mac

·??¹²³??????°? ??????????????????????????? ????? ???????????????????????? ??????????????? ????????????????? ?????

????????????????????  ½¼¾?????????????  ? ?????? ? ? ???? .
\begin{equation*}K?\end{equation*}
"K" & VBA.ChrW(8345)
\section{Test section}


------------------------------------Quick test--------------------------------------

\begin{tabular}{|c|c|}\hline\textbf{x}&\textbf{y}\\ \hline1&2\\ \hline2&$5,2$\\ \hline3&6\\ \hline\end{tabular}\textit{}\begin{equation*}Skriv ligningen her.\end{equation*}
\begin{equation*}Slet definitioner:\end{equation*}
------------------------------------Work in progress--------------------------------------

\begin{equation*}Slet definitioner:\end{equation*}Skal med i Test; Den virker nu, men ikke tidligere.Denne Differentialligning skal løses med bibetingelsen $N\left(30\right)=103$:\begin{equation*}N^{'}=0,00526\cdot N\cdot \left(209-N\right)\end{equation*}


Med GeoGebra kan man ikke løse denne ligning.
\begin{equation*}Definer:\overrightarrow{a}=\left(\begin{matrix}1\\2\end{matrix}\right),\overrightarrow{b}=\left(\begin{matrix}7\\-2\end{matrix}\right)\end{equation*}\begin{equation*}\cos \left(v\right)=\frac{dot\left(\overrightarrow{a};\overrightarrow{b}\right)}{|\overrightarrow{a}|\cdot |\overrightarrow{b}| }\end{equation*}


------------------------------- Not in testmodule ------------------------------------

\begin{equation*}|\left(\begin{matrix}\frac{100}{61}\\\frac{791}{61}\end{matrix}\right)-\left(\begin{matrix}c\\\frac{43}{3}-\left(\frac{5}{6}\right)c\end{matrix}\right)|\end{equation*}\begin{equation*}Hovedstol=Ydelse\cdot 1-\left(\frac{1+r\right)^{-n}}{r}\end{equation*}
Løs ligningssystem. Skal have to løsninger.
\begin{equation*}\left(x-38\right)^{2}+\left(y-18\right)^{2}=17,5^{2}\end{equation*}\begin{equation*}\left(x-27\right)^{2}+\left(y-33\right)^{2}=9,4^{2}\end{equation*}	$\Updownarrow $	\textit{Ligningssystemet løses for x,y vha. WordMat's 'Løs Ligninger' funktion, }\begin{equation*}\left(x=21,9832   \wedge     y=25,05068\right)  \vee    \left(x=36,08966   \wedge     y=35,39542\right)\end{equation*}\begin{equation*}Slet definitioner:\end{equation*}
\begin{equation*}8=\frac{\log \left(2\right)}{\log \left(a\right)} \end{equation*}	$\Updownarrow $	\textit{Ligningen løses for a vha. WordMat. }\begin{equation*}a=2^{\frac{1}{8}}\end{equation*}
fullratsimp(ConvertLog(ConvertToDegr(ev(%))))

denne giver ikke samme resultat på Win og Mac. Det er funktionen simplifynum, der ændrer udtrykket på Windows.
\begin{equation*}\int_{1}^{10}\sqrt{x^{-2}+1} dx\end{equation*}
\newpage
-------------------------------Run testmodule here------------------------------------
\begin{equation*}Slet definitioner:\end{equation*}
Alt+F8: RunTestSequence

Hvis denne løses med alt + L, så siger den ingen løsning. Hvis den løses med 'numeriske løsninger', så kommer den rigtige løsning x=144,87.\newline
Problemet skal undersøges i solvereal, der ikke skal returnere [], men gå til nsolve.\begin{equation*}Definer: f\left(x\right)={\begin{matrix}100\cdot 1,03^{x,}  0\leq x\leq 72\\33743\cdot 0,95^{x,}  72<x\leq 150\end{matrix}\end{equation*}
\begin{equation*}Slet definitioner:\end{equation*}\begin{equation*} 2+x=\end{equation*}
\textit{}\begin{equation*}a=12+34\end{equation*}\textit{\begin{equation}Skriv ligningen her.\end{equation}
}
\textit{
}



\end{document}
